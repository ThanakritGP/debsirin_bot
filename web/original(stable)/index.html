<!DOCTYPE html>
<html lang="th">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡∏ï‡∏ô DS COMMUNITY DISCORD</title>

  <link
    href="https://fonts.googleapis.com/css2?family=Noto+Sans+Thai:wght@100..900&family=Poppins:wght@100..900&display=swap"
    rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
  <link href="https://cdn.datatables.net/2.0.8/css/dataTables.bootstrap5.min.css" rel="stylesheet">
  <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  <script src="https://cdn.datatables.net/2.0.8/js/dataTables.min.js"></script>
  <script src="https://cdn.datatables.net/2.0.8/js/dataTables.bootstrap5.min.js"></script>
  <style>
    /* ... (CSS ‡∏™‡πà‡∏ß‡∏ô‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°) ... */
    html,
    body {
      min-height: 100%;
      height: auto;
    }

    body {
      font-family: 'Noto Sans Thai', sans-serif;
      background-color: #f8f9fa;
      color: #000000;
      text-align: center;
      padding-top: 70px;
    }

    body::before {
      content: "";
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: url('https://raw.githubusercontent.com/ThanakritGP/images/main/bg%20ds2.jpg') no-repeat center center;
      background-size: cover;
      opacity: 0.3;
      z-index: -1;
    }

    .main-content-wrapper {
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }

    #dynamic-content-area {
      padding-top: 20px;
      padding-bottom: 140px;
    }

    .card {
      border-radius: 15px;
      box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.1);
      margin-top: 0;
    }

    /* ... (CSS ‡∏™‡πà‡∏ß‡∏ô‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏ß‡∏≤‡∏á‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á) ... */
    .btn-custom {
      background-color: #007bff !important;
      color: white !important;
      font-weight: bold;
      border-radius: 8px;
      padding: 10px 20px;
      transition: background-color 0.3s ease-in-out;
    }

    .btn-custom:hover {
      background-color: #0056b3 !important;
    }

    #result {
      display: flex;
      justify-content: center;
      align-items: center;
      margin-top: 20px;
    }

    table {
      width: 100%;
      min-width: 300px;
      border-collapse: collapse;
      background: white;
      box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.1);
      border-radius: 10px;
      overflow: hidden;
      margin-left: auto;
      margin-right: auto;
    }

    th,
    td {
      border: 1px solid #ddd;
      padding: 10px;
      text-align: left;
    }

    th {
      background-color: #ffb300 !important;
      color: black !important;
    }

    #confirm-btn-container {
      display: none;
      width: 60%;
      min-width: 300px;
      margin: 15px auto 30px;
    }

    .btn-success {
      background-color: #28a745 !important;
      color: white !important;
      font-weight: bold;
      border-radius: 8px;
      padding: 10px 20px;
      transition: background-color 0.3s ease-in-out, box-shadow 0.3s ease-in-out;
      width: 100%;
      box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.2);
    }

    .btn-success:hover {
      background-color: #1e7e34 !important;
      box-shadow: 0px 6px 12px rgba(0, 0, 0, 0.3);
    }

    .btn-success:active {
      background-color: #19692c !important;
      box-shadow: 0px 3px 6px rgba(0, 0, 0, 0.3);
    }

    :root {
      --bs-success: #198754;
      --bs-success-hover: #157347;
      /* ‡∏™‡∏µ‡πÄ‡∏Ç‡πâ‡∏°‡∏Ç‡∏∂‡πâ‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö hover */
      --bs-success-light: rgba(25, 135, 84, 0.1);
      /* ‡∏™‡∏µ‡∏≠‡πà‡∏≠‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á active */
      --bs-success-lighter: rgba(25, 135, 84, 0.2);
      /* ‡∏™‡∏µ‡∏≠‡πà‡∏≠‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á hover */
    }

    /* ‚ú® ‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö FOOTER */
    footer {
      color: var(--bs-success);
    }

    footer a {
      color: var(--bs-success) !important;
    }

    footer .container-fluid {
      font-size: 0.9rem;
    }

    .icon-hover {
      transition: transform 0.3s ease, color 0.3s ease;
    }

    .icon-hover:hover {
      transform: scale(1.2);
      color: var(--bs-success-hover);
    }

    @media (max-width: 768px) {

      table,
      #confirm-btn-container {
        width: 90%;
      }
    }

    @media (max-width: 576px) {
      footer .container-fluid {
        flex-direction: column;
        text-align: center;
      }

      footer .container-fluid .d-flex {
        flex-direction: column;
        align-items: center;
      }

      footer .container-fluid div.text-start {
        text-align: center !important;
        margin-bottom: 5px;
      }

      footer a i {
        font-size: 1.5rem !important;
        color: var(--bs-success) !important;
        margin: 0 5px;
      }
    }

    .btn-discord {
      background-color: #5865F2 !important;
      color: white !important;
      font-weight: bold;
      border-radius: 8px;
      padding: 10px 20px;
      transition: background-color 0.3s ease-in-out;
    }

    .btn-discord:hover {
      background-color: #4752C4 !important;
    }

    @media (max-width: 991.98px) {
      .navbar .container-fluid {
        padding-left: 0.75rem !important;
        padding-right: 0.75rem !important;
      }

      .navbar-brand {
        color: var(--bs-success) !important;
        white-space: normal;
        word-break: break-word;
        font-size: 0.9rem;
        margin-right: 8px;
        line-height: 1.2;
      }

      .navbar-brand .fab.fa-discord {
        font-size: 1em;
        vertical-align: middle;
      }
    }

    @media (max-width: 420px) {
      .navbar-brand {
        font-size: 0.8rem;
      }

      .navbar-brand .fab.fa-discord {
        font-size: 1em;
      }

      .navbar .container-fluid {
        padding-left: 0.5rem !important;
        padding-right: 0.5rem !important;
      }
    }

    /* ‚ú® ‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö NAVLINK (Header) */
    /* ----------------------------------- */

    /* 1. ‡∏™‡∏µ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏Ç‡∏≠‡∏á Nav Link (‡πÅ‡∏Å‡πâ‡∏à‡∏≤‡∏Å‡πÇ‡∏Ñ‡πâ‡∏î‡πÄ‡∏î‡∏¥‡∏°) */
    .navbar-nav .nav-link {
      color: var(--bs-success) !important;
      padding-top: 0.25rem;
      padding-bottom: 0.25rem;
      padding-left: 0.8rem;
      padding-right: 0.8rem;
      border-radius: 0.3rem;
      transition: background-color 0.25s ease-out, transform 0.2s ease-out, box-shadow 0.25s ease-out;
      margin: 0 0.25rem;
    }

    /* 2. ‡∏™‡∏µ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ô‡∏≥‡πÄ‡∏°‡∏≤‡∏™‡πå‡πÑ‡∏õ‡∏ß‡∏≤‡∏á‡πÄ‡∏´‡∏ô‡∏∑‡∏≠‡∏•‡∏¥‡∏á‡∏Å‡πå (Hover/Focus) */
    .navbar-nav .nav-link:hover,
    .navbar-nav .nav-link:focus {
      color: var(--bs-success) !important;
      background-color: var(--bs-success-lighter);
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }

    /* 3. ‡∏™‡∏µ‡∏Ç‡∏≠‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏ó‡∏µ‡πà Active */
    .navbar-nav .nav-link.active {
      color: var(--bs-success) !important;
      font-weight: bold;
      background-color: var(--bs-success-light);
    }

    .navbar-nav .nav-link.active:hover,
    .navbar-nav .nav-link.active:focus {
      background-color: var(--bs-success-lighter);
      transform: translateY(-2px);
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15);
    }

    /* ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏ã‡πà‡∏≠‡∏ô Navbar ‡πÅ‡∏•‡∏∞ Footer ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡πÇ‡∏´‡∏°‡∏î Admin */
    body.admin-view nav.navbar,
    body.admin-view footer {
      display: none !important;
    }

    /* ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏ã‡πà‡∏≠‡∏ô Background ‡πÅ‡∏•‡∏∞‡∏•‡πâ‡∏≤‡∏á Padding */
    body.admin-view {
      margin: 0 !important;
      padding: 0 !important;
      background-color: #f8f9fc !important;
      /* ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏™‡∏µ‡πÄ‡∏ó‡∏≤‡∏≠‡πà‡∏≠‡∏ô‡πÅ‡∏ö‡∏ö SB Admin 2 */
      padding-top: 0 !important;
    }

    body.admin-view::before {
      opacity: 0 !important;
    }

    /* ‚≠ê‚≠ê‚≠ê CSS ‡∏™‡πà‡∏ß‡∏ô Admin Login/Dashboard (‡∏¢‡πâ‡∏≤‡∏¢‡∏°‡∏≤‡∏à‡∏≤‡∏Å admin_page.html) ‚≠ê‚≠ê‚≠ê */
    .login-full-page {
      min-height: calc(100vh - 60px);
      height: auto;
      background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 30px 0;
    }

    .login-container {
      background: white;
      border-radius: 20px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
      width: 100%;
      max-width: 450px;
      padding: 20px 28px !important;
      /* ‚Üê ‡∏•‡∏î‡∏•‡∏á */
      animation: slideUp 0.6s ease-out;
    }

    @keyframes slideUp {
      from {
        opacity: 0;
        transform: translateY(30px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .logo-section {
      background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
      padding: 20px 20px 15px;
      text-align: center;
      border-bottom: 1px solid #e9ecef;
    }

    .logo-section img {
      width: 280px;
      max-width: 180px;
      height: auto;
      margin-bottom: 15px;
      filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.1));
    }

    .logo-section h1 {
      font-size: 1.4rem;
      color: #2c3e50;
      font-weight: 600;
      margin-top: 10px;
      margin-bottom: 5px;
    }

    .logo-section p {
      color: #7f8c8d;
      font-size: 14px;
      font-weight: 300;
      margin-bottom: 15px;
    }

    .form-section {
      margin-top: 10px;
    }

    .form-group {
      margin-bottom: 25px;
    }

    .login-container label {
      display: block;
      margin-bottom: 8px;
      color: #34495e;
      font-weight: 500;
      font-size: 14px;
    }

    /* ‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö input type ‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡πÉ‡∏ä‡πâ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô */
    input[type="text"],
    input[type="password"] {
      width: 100%;
      padding: 14px 16px;
      border: 2px solid #e9ecef;
      border-radius: 10px;
      font-size: 15px;
      font-family: 'Noto Sans Thai', sans-serif;
      transition: all 0.3s ease;
      background-color: #f8f9fa;
    }

    input:focus {
      outline: none;
      border-color: #17a2b8;
      background-color: white;
      box-shadow: 0 0 0 4px rgba(23, 162, 184, 0.1);
    }

    .login-button {
      width: 100%;
      padding: 14px;
      background: linear-gradient(135deg, #17a2b8 0%, #138496 100%);
      color: white;
      border: none;
      border-radius: 10px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      font-family: 'Noto Sans Thai', sans-serif;
      box-shadow: 0 4px 15px rgba(23, 162, 184, 0.3);
    }

    .login-button:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(23, 162, 184, 0.4);
    }

    .login-button:active {
      transform: translateY(0);
    }

    /* ‡∏ã‡πà‡∏≠‡∏ô navbar + footer ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏´‡∏ô‡πâ‡∏≤ Login */
    .login-full-page~nav.navbar,
    .login-full-page~footer {
      display: none !important;
    }

    /* ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡πÄ‡∏ï‡πá‡∏°‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠ */
    .login-full-page {
      min-height: 100vh;
    }

    .metric-card {
      display: flex;
      align-items: center;
      gap: 16px;
      padding: 20px;
      border-radius: 14px;
      background: #fff;
      box-shadow: 0 8px 24px rgba(0, 0, 0, .06);
      transition: all .25s ease;
      height: 100%;
    }

    .metric-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 12px 32px rgba(0, 0, 0, .12);
    }

    /* ICON */
    .metric-icon {
      width: 56px;
      height: 56px;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      color: #fff;
    }

    /* CONTENT */
    .metric-content h6 {
      margin: 0;
      font-size: 14px;
      color: #6c757d;
    }

    .metric-number {
      font-size: 32px;
      font-weight: 700;
      margin-top: 4px;
    }

    /* COLORS */
    .metric-card.primary .metric-icon {
      background: linear-gradient(135deg, #0d6efd, #3d8bfd);
    }

    .metric-card.success .metric-icon {
      background: linear-gradient(135deg, #198754, #20c997);
    }

    .metric-card.warning .metric-icon {
      background: linear-gradient(135deg, #ffc107, #ffca2c);
    }

    /* ‡∏ä‡∏¥‡∏î‡∏ã‡πâ‡∏≤‡∏¢‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° */
    #studentsTable td,
    #studentsTable th {
      text-align: left;
    }

    /* ‡∏¢‡∏Å‡πÄ‡∏ß‡πâ‡∏ô element ‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° */
    #studentsTable td button,
    #studentsTable td .btn,
    #studentsTable td i,
    #studentsTable td svg,
    #studentsTable td .badge {
      text-align: center;
    }

    .metric-card {
      height: 120px;
      display: flex;
      align-items: center;
      padding: 16px;
      border-radius: 12px;
    }

    .metric-icon {
      font-size: 36px;
      margin-right: 15px;
    }

    .metric-content h6 {
      margin: 0;
      font-size: 14px;
    }

    .metric-number {
      font-size: 24px;
      font-weight: bold;
      margin-top: 4px;
    }

    .admin-topbar {
      height: 56px;
      background-color: #ffffff;
      border-bottom: 1px solid #e5e7eb;
      position: sticky;
      top: 0;
      z-index: 1000;
    }

    /* ‡∏õ‡∏£‡∏±‡∏ö DataTables ‡πÉ‡∏´‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏Å‡∏±‡∏ö Bootstrap */
    .dataTables_wrapper {
      width: 100%;
    }

    .dataTables_filter label,
    .dataTables_length label {
      margin-bottom: 0;
      font-weight: 500;
    }

    /* ‡∏ä‡πà‡∏≠‡∏á search */
    .dataTables_filter label {
      display: flex;
      align-items: center;
      gap: 8px;
      white-space: nowrap;
    }

    /* select ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÅ‡∏ñ‡∏ß */
    .dataTables_length select {
      border-radius: 6px;
      border: 1px solid #ced4da;
      padding: 4px 6px;
    }

    /* pagination */
      .dataTables_paginate .pagination {
      margin: 0;
    }

    /* ‡∏ä‡πà‡∏≠‡∏á‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ */
    .dataTables_filter input {
      margin: 0 !important;
    }

    .table-responsive {
      /* ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç: ‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ overflow-x: auto; */
      overflow-x: auto !important;
      -webkit-overflow-scrolling: touch; /* ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ö‡∏ô iOS ‡∏•‡∏∑‡πà‡∏ô‡πÑ‡∏´‡∏• */
    }
  </style>
</head>

<body>

  <?!= HtmlService.createHtmlOutputFromFile('header').getContent(); ?>

  <div class="main-content-wrapper">
    <div id="dynamic-content-area" class="container"></div>
  </div>

  <?!= HtmlService.createHtmlOutputFromFile('footer').getContent(); ?>

  <script>
    /* --------------- JS CODE (CLEANED) --------------- */
    
    let placeholderAnimationIntervalId = null;
    let placeholderAnimationTimeoutId = null;
    let shouldStopPlaceholderAnimation = false;

    function animateDynamicPlaceholder(element, texts, config) {
      if (!element) return;
      const originalStaticPlaceholder = element.getAttribute('placeholder') || '';
      const defaults = {
        prefix: ">>...",
        suffix: "...",
        typeSpeed: 120,
        eraseSpeed: 70,
        pauseAfterType: 2000,
        pauseAfterErase: 700,
        initialDelay: 500
      };
      const settings = { ...defaults, ...config };
      let textIndex = 0;
      let charIndex = 0;
      let currentDisplay = "";
      let isErasing = false;

      function clearAllTimers() {
        if (placeholderAnimationIntervalId) clearInterval(placeholderAnimationIntervalId);
        if (placeholderAnimationTimeoutId) clearTimeout(placeholderAnimationTimeoutId);
        placeholderAnimationIntervalId = null;
        placeholderAnimationTimeoutId = null;
      }

      function typeCharacter() {
        if (shouldStopPlaceholderAnimation) return;
        const fullText = settings.prefix + texts[textIndex] + settings.suffix;
        if (charIndex < fullText.length) {
          currentDisplay += fullText.charAt(charIndex);
          element.placeholder = currentDisplay;
          charIndex++;
        } else {
          clearAllTimers();
          placeholderAnimationTimeoutId = setTimeout(() => {
            if (shouldStopPlaceholderAnimation) return;
            isErasing = true;
            startErasing();
          }, settings.pauseAfterType);
        }
      }

      function eraseCharacter() {
        if (shouldStopPlaceholderAnimation) return;
        if (currentDisplay.length > 0) {
          currentDisplay = currentDisplay.substring(0, currentDisplay.length - 1);
          element.placeholder = currentDisplay;
        } else {
          clearAllTimers();
          isErasing = false;
          charIndex = 0;
          textIndex = (textIndex + 1) % texts.length;
          placeholderAnimationTimeoutId = setTimeout(() => {
            if (shouldStopPlaceholderAnimation) return;
            startTyping();
          }, settings.pauseAfterErase);
        }
      }

      function startTyping() {
        if (shouldStopPlaceholderAnimation) return;
        clearAllTimers();
        currentDisplay = "";
        element.placeholder = "";
        placeholderAnimationIntervalId = setInterval(typeCharacter, settings.typeSpeed);
      }

      function startErasing() {
        if (shouldStopPlaceholderAnimation) return;
        clearAllTimers();
        placeholderAnimationIntervalId = setInterval(eraseCharacter, settings.eraseSpeed);
      }

      const stopAnimationHandler = () => {
        if (!shouldStopPlaceholderAnimation) {
          shouldStopPlaceholderAnimation = true;
          clearAllTimers();
          element.placeholder = originalStaticPlaceholder;
          element.removeEventListener('input', stopAnimationHandler);
        }
      };

      element.removeEventListener('input', stopAnimationHandler);
      element.addEventListener('input', stopAnimationHandler);

      shouldStopPlaceholderAnimation = false;
      clearAllTimers();
      placeholderAnimationTimeoutId = setTimeout(startTyping, settings.initialDelay);
    }

    function initializePlaceholderAnimation(elementId, textsArray, configOptions) {
      const inputElement = document.getElementById(elementId);
      if (inputElement) {
        animateDynamicPlaceholder(inputElement, textsArray, configOptions);
      }
    }

    // ‚≠ê‚≠ê ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô showLoadingSweetAlert ‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ Bootstrap Spinner ‚≠ê‚≠ê
    function showLoadingSweetAlert(pageName) {
      Swal.fire({
        title: '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î ' + pageName + '...',
        // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏°‡∏≤‡πÉ‡∏ä‡πâ HTML Spinner ‡∏ó‡∏µ‡πà‡πÄ‡∏™‡∏ñ‡∏µ‡∏¢‡∏£‡∏Å‡∏ß‡πà‡∏≤‡πÅ‡∏ó‡∏ô didOpen: () => Swal.showLoading()
        html: `
            <div class="d-flex justify-content-center align-items-center flex-column py-2">
                <div class="spinner-border text-primary" role="status">
                    <span class="visually-hidden">Loading...</span>
                </div>
                <p class="mt-3 mb-0 text-muted">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà</p>
            </div>
        `,
        allowOutsideClick: false,
        allowEscapeKey: false,
        showConfirmButton: false,
      });
    }

    function setActiveNavLink(activeLinkId) {
      document.querySelectorAll('.navbar-nav .nav-link').forEach(link => {
        link.classList.remove('active');
        link.removeAttribute('aria-current');
      });

      const activeLink = document.getElementById(activeLinkId);
      if (activeLink) {
        activeLink.classList.add('active');
        activeLink.setAttribute('aria-current', 'page');
      }
    }

    function loadMainPage() {
      showLoadingSweetAlert('‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡∏ï‡∏ô');

      // üîÅ ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ö‡∏ô‡∏™‡∏∏‡∏î‡πÄ‡∏™‡∏°‡∏≠
      window.scrollTo(0, 0);

      // ‡πÅ‡∏™‡∏î‡∏á Navbar + Footer
      document.querySelector('nav.navbar').style.display = '';
      document.querySelector('footer').style.display = '';

      // ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡πÇ‡∏´‡∏°‡∏î Admin
      document.body.classList.remove('admin-view');

      const area = document.getElementById('dynamic-content-area');

      // ‚≠ê‚≠ê‚≠ê ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏°‡∏≤‡∏Å: ‡∏•‡πâ‡∏≤‡∏á style ‡∏ó‡∏µ‡πà‡∏Ñ‡πâ‡∏≤‡∏á‡∏à‡∏≤‡∏Å admin ‚≠ê‚≠ê‚≠ê
      area.classList.add('container');
      area.style.padding = '';
      area.style.margin = '';

      google.script.run
        .withSuccessHandler(html => {
          area.innerHTML = html;

          // reset state
          foundStudentData = null;

          const idInput = document.getElementById('id');
          if (idInput) idInput.value = '';

          const resultDiv = document.getElementById('result');
          if (resultDiv) resultDiv.innerHTML = '';

          const confirmBtnContainer = document.getElementById('confirm-btn-container');
          if (confirmBtnContainer) confirmBtnContainer.style.display = 'none';

          Swal.close();
          document.body.classList.remove('swal2-shown', 'swal2-height-auto');

          setActiveNavLink('nav-main-page');

          initializePlaceholderAnimation('id', ["‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô"], {
            prefix: ">>...",
            suffix: "...",
            typeSpeed: 120,
            eraseSpeed: 70,
            pauseAfterType: 2500,
            pauseAfterErase: 500,
            initialDelay: 800
          });
        })
        .withFailureHandler(error => {
          Swal.close();
          document.body.classList.remove('swal2-shown', 'swal2-height-auto');
          Swal.fire(
            '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î',
            '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡∏ï‡∏ô‡πÑ‡∏î‡πâ: ' + (error.message || error),
            'error'
          );
        })
        .getMainContent();
    }

    function loadHowToPage() {
      showLoadingSweetAlert('‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡∏ï‡∏ô');

      google.script.run
        .withSuccessHandler(html => {
          document.getElementById('dynamic-content-area').innerHTML = html;
          Swal.close();
          document.body.classList.remove('swal2-shown', 'swal2-height-auto'); // ‡∏ó‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏≠‡∏≤‡∏î
          setActiveNavLink('nav-how-to-page');
        })
        .withFailureHandler(error => {
          Swal.close();
          document.body.classList.remove('swal2-shown', 'swal2-height-auto'); // ‡∏ó‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏≠‡∏≤‡∏î
          Swal.fire('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î', '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡∏ï‡∏ô‡πÑ‡∏î‡πâ: ' + (error.message || error), 'error');
        })
        .getHowToContent();
    }

    function handleAdminLoginResponse(response) {
      Swal.close();
      document.body.classList.remove('swal2-shown', 'swal2-height-auto');

      if (response.success) {
        localStorage.setItem('adminToken', response.token); 

        Swal.fire({
          icon: 'success',
          title: '‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!',
          showConfirmButton: false,
          timer: 1000
        }).then(() => {

          const loginSection = document.getElementById('login-section');
          const dashboardSection = document.getElementById('dashboard-section');

          if (loginSection && dashboardSection) {
            loginSection.style.display = 'none';
            dashboardSection.style.display = 'block';

            // ‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
            setTimeout(() => {
              updateAdminTopbar(response.name || '‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö');
            }, 0);

            // ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Dashboard
            if (typeof loadMetrics === 'function') {
              loadMetrics();
            }

          } else {
            Swal.fire('‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡∏†‡∏≤‡∏¢‡πÉ‡∏ô', '‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏™‡πà‡∏ß‡∏ô Login/Dashboard ‡πÉ‡∏ô HTML', 'error');
            document.body.classList.remove('admin-view');
          }
        });

      } else {
        Swal.fire({
          icon: 'error',
          title: '‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à',
          text: response.message || '‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á',
          confirmButtonText: '‡∏•‡∏≠‡∏á‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á'
        });
      }
    }

    // function loadAdminPage() {
    //    Swal.close();
    //   // 1. ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡πÇ‡∏´‡∏°‡∏î Admin
    //   document.body.classList.add('admin-view');
    //   document.getElementById('dynamic-content-area').classList.remove('container');
    //   document.getElementById('dynamic-content-area').style.padding = "0";
    //   document.getElementById('dynamic-content-area').style.margin = "0";


    //   // ‚≠ê‚≠ê ‡πÄ‡∏Ñ‡∏•‡∏µ‡∏¢‡∏£‡πå‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏à‡∏≤‡∏Å‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏Å‡πà‡∏≤‡∏≠‡∏≠‡∏Å‡∏ó‡∏±‡∏ô‡∏ó‡∏µ ‚≠ê‚≠ê
    //   document.getElementById('dynamic-content-area').innerHTML = `
    //     <div class="text-center py-5">
    //       <div class="spinner-border text-primary" role="status"></div>
    //       <p class="mt-3 text-muted">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤ Admin...</p>
    //     </div>
    //   `;

    //   // 2. ‡πÇ‡∏´‡∏•‡∏î Admin Page
    //   google.script.run
    //     .withSuccessHandler(html => {
    //       Swal.close();
    //       document.body.classList.remove('swal2-shown', 'swal2-height-auto');
    //       document.getElementById('dynamic-content-area').innerHTML = html;

    //       const scriptElement = document
    //         .getElementById('dynamic-content-area')
    //         .querySelector('script');

    //       if (scriptElement) {
    //         const scriptContent = scriptElement.textContent;
    //         scriptElement.remove();
    //         const newScript = document.createElement('script');
    //         newScript.textContent = scriptContent;
    //         document.body.appendChild(newScript);
    //       }

    //       // üî¥üî¥üî¥ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ üî¥üî¥üî¥
    //       if (typeof loadAllStudentsTable === 'function') {
    //         loadAllStudentsTable();
    //       }

    //       if (typeof loadMetrics === 'function') {
    //         loadMetrics();
    //       }
    //     })
    //     .withFailureHandler(error => {
    //       Swal.close();
    //       document.body.classList.remove('swal2-shown', 'swal2-height-auto');
    //       Swal.fire('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î', '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤ Admin ‡πÑ‡∏î‡πâ: ' + (error.message || error), 'error');

    //       document.body.classList.remove('admin-view');
    //       document.getElementById('dynamic-content-area').classList.add('container');
    //     })
    //     .getAdminPage();
    // }

    function loadAdminPage() {
      Swal.close();
      
      // 1. ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡πÇ‡∏´‡∏°‡∏î Admin View
      document.body.classList.add('admin-view');
      document.getElementById('dynamic-content-area').classList.remove('container');
      document.getElementById('dynamic-content-area').style.padding = "0";
      document.getElementById('dynamic-content-area').style.margin = "0";

      const token = localStorage.getItem('adminToken');
      const dynamicArea = document.getElementById('dynamic-content-area');

      // 2. ‡πÅ‡∏™‡∏î‡∏á Loading Screen ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
      dynamicArea.innerHTML = `
          <div class="login-full-page d-flex justify-content-center align-items-center">
              <div class="text-center">
                  <div class="spinner-border text-primary" role="status"></div>
                  <p class="mt-3 text-muted">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå Admin...</p>
              </div>
          </div>
      `;

      if (token) {
          google.script.run
              .withSuccessHandler(r => {
                  if (r.success) {
                      loadAdminContent(r.name, true); 
                  } else {
                      localStorage.removeItem('adminToken');
                      loadAdminContent(null, false); 
                      Swal.fire('‡πÄ‡∏ã‡∏™‡∏ä‡∏±‡∏ô‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏', '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á', 'warning');
                  }
              })
              .withFailureHandler(err => {
                  loadAdminContent(null, false); 
                  Swal.fire('Server Error', '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÑ‡∏î‡πâ: ' + (err.message || err), 'error');
              })
              .checkAdminToken(token);
              
      } else {
          loadAdminContent(null, false);
      }
    }

    function loadAdminContent(adminName, showDashboard) {
      const oldAdminScript = document.querySelector('script[data-admin-script]');
      if (oldAdminScript) oldAdminScript.remove();

      google.script.run
        .withSuccessHandler(adminHtml => {
          Swal.close();
          document.body.classList.remove('swal2-shown', 'swal2-height-auto');

          const dynamicArea = document.getElementById('dynamic-content-area');
          dynamicArea.innerHTML = adminHtml;

          // inject script ‡∏à‡∏≤‡∏Å admin_page.html
          const scriptEl = dynamicArea.querySelector('script');
          if (scriptEl) {
            const newScript = document.createElement('script');
            newScript.textContent = scriptEl.textContent;
            newScript.setAttribute('data-admin-script', 'true');
            scriptEl.remove();
            document.body.appendChild(newScript);
          }

          const loginSection = document.getElementById('login-section');
          const dashboardSection = document.getElementById('dashboard-section');

          // ‚≠ê ‡∏à‡∏∏‡∏î‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à‡πÄ‡∏î‡∏µ‡∏¢‡∏ß (Single source of truth)
          if (loginSection && dashboardSection) {
            loginSection.style.display = showDashboard ? 'none' : 'flex';
            dashboardSection.style.display = showDashboard ? 'block' : 'none';
          }

          if (showDashboard) {
            if (typeof updateAdminTopbar === 'function') {
              updateAdminTopbar(adminName || '‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö');
            }
            if (typeof loadMetrics === 'function') loadMetrics();
            if (typeof loadAllStudentsTable === 'function') loadAllStudentsTable();
          }
        })
        .withFailureHandler(error => {
          Swal.close();
          loadMainPage();
          Swal.fire(
            '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î',
            '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤ Admin ‡πÑ‡∏î‡πâ: ' + (error.message || error),
            'error'
          );
        })
        .getAdminPage();
    }

    let foundStudentData = null;

    function info() {
      let obj = document.querySelector('#id').value.trim();
      let updateLocation = document.querySelector('#result');
      let confirmBtn = document.getElementById('confirm-btn-container');

      updateLocation.innerHTML = "";
      confirmBtn.style.display = 'none';
      foundStudentData = null;

      if (!/^\d{5}$/.test(obj)) {
        Swal.fire({
          icon: 'warning',
          title: '‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á',
          text: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô 5 ‡∏´‡∏•‡∏±‡∏Å‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô',
          confirmButtonColor: '#ffc107'
        });
        return;
      }

      Swal.fire({
        title: '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...',
        text: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà',
        allowOutsideClick: false,
        allowEscapeKey: false,
        showConfirmButton: false,
        html: `
            <div class="d-flex justify-content-center align-items-center flex-column py-2">
                <div class="spinner-border text-primary" role="status">
                    <span class="visually-hidden">Loading...</span>
                </div>
                <p class="mt-3 mb-0 text-muted">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà</p>
            </div>
        `,
      });

      google.script.run.withFailureHandler(onFailure).withSuccessHandler(onSuccess).submitData(obj);
    }

    function onFailure(error) {
      Swal.close();
      document.body.classList.remove('swal2-shown', 'swal2-height-auto'); // ‡∏ó‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏≠‡∏≤‡∏î
      Swal.fire({
        icon: 'error',
        title: '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î!',
        text: error ? error.message || error : '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå‡πÑ‡∏î‡πâ',
        confirmButtonColor: '#dc3545'
      });

      document.querySelector('#result').innerHTML = "";
      foundStudentData = null;
      document.getElementById('confirm-btn-container').style.display = 'none';
    }

    function onSuccess(response) {
      Swal.close();
      document.body.classList.remove('swal2-shown', 'swal2-height-auto'); // ‡∏ó‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏≠‡∏≤‡∏î

      let updateLocation = document.querySelector('#result');
      let confirmBtn = document.getElementById('confirm-btn-container');

      if (response && response.status) {
        if (response.status === "verified") {
          Swal.fire({
            icon: 'success',
            title: response.message,
            text: response.action,
            confirmButtonText: '‡πÄ‡∏õ‡∏¥‡∏î Discord',
            confirmButtonColor: '#5865F2'
          })
            .then(result => {
              if (result.isConfirmed) {
                window.open("https://discord.com/channels/1294949467505823755/1356492832210288774", "_blank");
                setTimeout(() => {
                  window.location.href = "discord://discord.com/channels/1294949467505823755/1356492832210288774";
                }, 500);
              }
            });
        }

        else if (response.status === "found_not_verified") {
          Swal.fire({
            icon: 'info',
            title: response.message,
            text: response.action,
            confirmButtonColor: '#28a745'
          });

          updateLocation.innerHTML = response.data;
          confirmBtn.style.display = 'block';
          foundStudentData = response;
        }

        else if (response.status === "not_found" || response.status === "error") {
          Swal.fire({
            icon: 'error',
            title: response.message,
            text: response.action,
            confirmButtonColor: '#dc3545'
          });
        }
      }

      else {
        Swal.fire({
          icon: 'error',
          title: '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•',
          text: '‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á',
          confirmButtonColor: '#dc3545'
        });

        foundStudentData = null;
      }
    }

    function confirmIdentity() {
      if (!foundStudentData || foundStudentData.status !== "found_not_verified") {
        Swal.fire({
          icon: 'error',
          title: '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î!',
          text: '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡∏ï‡∏ô‡πÑ‡∏î‡πâ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå',
          confirmButtonColor: '#dc3545'
        });
        return;
      }

      let { id: studentId, fullName, classLevel, room } = foundStudentData;

      Swal.fire({
        title: '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡∏ï‡∏ô...',
        text: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà',
        allowOutsideClick: false,
        allowEscapeKey: false,
        showConfirmButton: false,
        html: `
            <div class="d-flex justify-content-center align-items-center flex-column py-2">
                <div class="spinner-border text-primary" role="status">
                    <span class="visually-hidden">Loading...</span>
                </div>
                <p class="mt-3 mb-0 text-muted">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà</p>
            </div>
        `,
      });

      google.script.run
        .withSuccessHandler(() => {
          google.script.run
            .withSuccessHandler(() => {
              Swal.fire({
                icon: 'success',
                title: '‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡∏ï‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!',
                text: '‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô Discord ‡πÑ‡∏î‡πâ‡πÅ‡∏•‡πâ‡∏ß',
                confirmButtonText: '‡πÄ‡∏õ‡∏¥‡∏î Discord',
                confirmButtonColor: '#5865F2'
              })
                .then(result => {
                  if (result.isConfirmed) {
                    window.open("https://discord.com/channels/1294949467505823755/1356492832210288774", "_blank");
                    setTimeout(() => {
                      window.location.href = "discord://discord.com/channels/1294949467505823755/1356492832210288774";
                    }, 500);
                  }
                });

              document.getElementById('confirm-btn-container').style.display = 'none';
              document.querySelector('#result').innerHTML = "";
              foundStudentData = null;
              document.querySelector('#id').value = "";
            })
            .withFailureHandler(err => {
              Swal.close();
              document.body.classList.remove('swal2-shown', 'swal2-height-auto'); // ‡∏ó‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏≠‡∏≤‡∏î
              Swal.fire('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î', '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡∏¢‡∏±‡∏á Discord: ' + (err.message || err), 'error');
            })
            .sendToDiscord(studentId, fullName, classLevel, room);
        })
        .withFailureHandler(err => {
          Swal.close();
          document.body.classList.remove('swal2-shown', 'swal2-height-auto'); // ‡∏ó‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏≠‡∏≤‡∏î
          Swal.fire('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î', '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô: ' + (err.message || err), 'error');
        })
        .logVerification(studentId);
    }

    document.addEventListener('DOMContentLoaded', () => {
      loadMainPage();
    });
  </script>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>